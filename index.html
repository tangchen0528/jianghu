<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#000000">
    <title>情義江湖点歌系统</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            width: 100vw;
            height: 100vh;
            overflow-x: hidden;
        }
        img {
            max-width: 100%;
            height: auto;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Microsoft YaHei', sans-serif;
            color: #fff;
            min-height: 100vh;
            background-color: #8B0000;
            background-image: none;
            overflow-x: hidden;
            overflow-y: hidden;
            -webkit-overflow-scrolling: touch;
            padding: 0;
        }
        .bg-container {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 0;
            background-size: cover; background-position: center; opacity: 1;
            transition: opacity 0.8s ease-in-out, background-image 0.8s ease-in-out;
        }
        .container {
            background-color: transparent;
            border-radius: 0;
            box-shadow: none;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 100vh;
            width: 100%;
            position: relative;
            z-index: 10;
        }
        .header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background: rgba(0,0,0,0.2); color: #FFD700; padding: 15px; text-align: center;
            border-bottom: 2px solid #FF6B6B;
            z-index: 100;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .header h1 {
            font-size: 28px; font-weight: 800; letter-spacing: 2px; font-family: 'Arial Black', sans-serif;
            text-shadow: 0 2px 5px rgba(0,0,0,0.8); margin: 0;
        }
        .fixed-header {
            position: fixed;
            top: 80px;
            left: 0;
            width: 100%;
            background-color: rgba(0,0,0,0.2);
            padding: 12px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            z-index: 90;
            height: 140px;
            box-sizing: border-box;
        }
        .artist-section {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-bottom: 12px;
            height: 80px;
        }
        .tag-btn {
            height: 40px; background-color: rgba(255,255,255,0.1); color: #fff; border-radius: 8px;
            font-weight: 700; cursor: pointer; transition: all 0.2s ease; border: 1px solid rgba(255,255,255,0.2);
            text-align: center; box-shadow: 0 2px 5px rgba(0,0,0,0.2); display: flex; align-items: center;
            justify-content: center; font-size: 11px; white-space: nowrap; overflow: hidden;
            text-overflow: ellipsis; padding: 0 8px;
        }
        .tag-btn:active { transform: scale(0.95); background-color: rgba(255,215,0,0.3); }
        .tag-btn.active {
            background: linear-gradient(45deg, #FFD700, #FFA500); color: #8B0000;
            box-shadow: 0 4px 8px rgba(255,215,0,0.4);
        }
        .search-box {
            background-color: transparent;
            padding: 0;
            margin-top: 10px;
            height: 36px;
        }
        #searchInput {
            width: 100%;
            padding: 8px 15px;
            border-radius: 6px;
            border: 1px solid rgba(255,255,255,0.2);
            font-size: 14px;
            color: #fff;
            background-color: rgba(0,0,0,0.2);
            outline: none;
            height: 100%;
        }
        #searchInput::placeholder { color: #ccc; }
        .list-title {
            position: fixed;
            top: 220px;
            left: 0;
            width: 100%;
            padding: 10px 15px;
            background-color: rgba(0,0,0,0.3);
            border-top: 1px solid rgba(255,255,255,0.1);
            border-bottom: 1px solid rgba(255,255,255,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 8px;
            z-index: 80;
            height: 50px;
        }
        .list-title h2 {
            font-size: 14px;
            color: #FFD700; font-weight: 700; border-left: 3px solid #FFD700;
            padding-left: 8px; margin: 0; display: flex; align-items: center; flex: 1;
            line-height: 1;
        }
        .song-count {
            margin-left: 8px;
            font-size: 12px;
            color: #fff !important;
        }
        .list-control-btn {
            background: none; border: none; padding: 6px 10px;
            border-radius: 0; cursor: pointer;
            display: flex; align-items: center; gap: 4px;
            font-size: 12px;
            color: #FFD700;
            font-weight: bold; transition: background-color 0.2s;
            height: 35px;
        }
        .list-control-btn:hover { background-color: rgba(255,255,255,0.2); }
        .arrow-icon {
            width: 12px;
            height: 12px;
            fill: #FFD700;
        }
        .modal {
            display: none;
            position: absolute;
            top: 10px;
            right: 12px;
            width: 160px;
            height: auto;
            background-color: transparent;
            z-index: 1001;
            padding: 0;
            margin-top: 10px;
        }
        .modal-content {
            background-color: rgba(34,34,34,0.8);
            padding: 15px;
            border-radius: 10px;
            width: 100%;
            box-shadow: 0 4px 20px rgba(255,215,0,0.4);
            border: 1px solid #FFD700;
            margin-top: 0;
        }
        .modal-title {
            color: #FFD700;
            margin-bottom: 10px;
            font-size: 14px;
            text-align: center;
            border-bottom: 1px solid #FFD700;
            padding-bottom: 8px;
        }
        .modal-option {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 6px 0;
            border-bottom: 1px solid #333;
            color: #fff;
            font-size: 12px;
        }
        .modal-option label { flex: 1; }
        .modal-option input { transform: scale(1); margin-right: 5px; }
        .modal-footer { display: flex; justify-content: space-around; margin-top: 10px; }
        .modal-btn {
            padding: 4px 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            font-size: 12px;
        }
        .btn-confirm { background-color: #FFD700; color: #8B0000; }
        .btn-cancel { background-color: #555; color: #fff; }

        .song-list-wrapper {
            position: fixed;
            top: 270px;
            left: 0;
            bottom: 65px;
            width: 100%;
            padding: 10px 8px 15px 8px;
            overflow-y: auto !important;
            overflow-x: hidden;
            background-color: rgba(0,0,0,0.1);
            -webkit-overflow-scrolling: touch;
            touch-action: pan-y;
            z-index: 70;
        }

        .song-list-wrapper::-webkit-scrollbar { width: 6px; }
        .song-list-wrapper::-webkit-scrollbar-track { background: rgba(0,0,0,0.2); border-radius: 3px; }
        .song-list-wrapper::-webkit-scrollbar-thumb { background: #FF6B6B; border-radius: 3px; }

        .song-list-content {
            display: grid;
            gap: 8px;
            transition: all 0.3s ease;
            width: 100%;
            padding-bottom: 15px;
        }
        .song-list-content.single-col {
            grid-template-columns: 1fr;
        }
        .song-list-content.two-col {
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
        }
        .song-list-content.three-col {
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
        }

        .song-item {
            display: flex;
            align-items: center;
            background: rgba(255,255,255,0.08);
            border-radius: 8px;
            padding: 8px 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
            border: 1px solid rgba(255,255,255,0.1);
            position: relative;
            transition: background-color 0.3s ease;
            min-height: 55px;
            width: 100%;
            box-sizing: border-box;
            flex-shrink: 0;
        }
        .song-item.collect-active {
            background-color: rgba(255,255,255,0.08);
            border-color: rgba(255,255,255,0.1);
        }
        .thumbnail {
            width: clamp(30px, 8vw, 40px);
            height: clamp(30px, 8vw, 40px);
            border-radius: 6px;
            overflow: hidden;
            flex-shrink: 0;
            background: #fff;
            margin-right: 5px;
        }
        .placeholder-img {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #333;
            font-weight: bold;
            font-size: clamp(10px, 2vw, 12px);
            background: linear-gradient(45deg, #fff, #f0f0f0);
        }
        .song-details {
            flex: 1;
            margin-left: 5px;
            overflow: hidden;
            padding-right: 20px;
        }
        .song-title {
            font-size: clamp(12px, 3vw, 14px);
            font-weight: 600;
            color: #fff;
            margin-bottom: 4px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            line-height: 1.2;
        }
        .song-artist {
            font-size: clamp(10px, 2vw, 11px);
            color: #ccc;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            line-height: 1.2;
        }
        .collect-star {
            position: absolute;
            right: clamp(10px, 3%, 15px);
            bottom: clamp(10px, 3%, 15px);
            font-size: clamp(12px, 2vw, 15px);
            color: #fff;
            cursor: pointer;
            transition: color 0.2s ease, transform 0.2s ease;
            flex-shrink: 0;
            z-index: 10;
        }
        .collect-star.active { color: #FFD700; transform: scale(1.1); }
        .collect-star:active { transform: scale(0.9); }
        .no-song-tip {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: #ccc;
            font-size: 16px;
            padding: 20px 0;
        }
        .collect-tip {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 10px 20px;
            background-color: rgba(0,0,0,0.8);
            color: #FFD700;
            border-radius: 6px;
            font-size: 14px;
            z-index: 9999;
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }
        .collect-tip.show { opacity: 1; }

        .collect-page {
            display: none;
            position: fixed;
            top: 270px;
            left: 0;
            bottom: 65px;
            width: 100%;
            padding: 15px 8px;
            text-align: center;
            align-items: flex-start;
            justify-content: flex-start;
            flex-direction: column;
            color: #ccc;
            overflow-y: auto !important;
            -webkit-overflow-scrolling: touch;
            touch-action: pan-y;
            z-index: 70;
            background-color: rgba(0,0,0,0.1);
        }
        .collect-page h3 { color: #FFD700; margin-bottom: 15px; width: 100%; text-align: center; }
        .collect-page .song-list-content {
            width: 100%;
            display: grid;
            grid-template-columns: 1fr;
            gap: 8px;
        }
        .collect-page .song-item {
            min-height: 55px;
            width: 100%;
        }
        .collect-page .song-details { padding-right: 20px; }

        .setting-page {
            display: none;
            position: fixed;
            top: 80px;
            left: 0;
            bottom: 65px;
            width: 100%;
            background-color: rgba(0,0,0,0.2);
            backdrop-filter: blur(5px);
            flex-direction: row;
            overflow-y: hidden;
            z-index: 85;
        }
        .setting-sidebar {
            width: 120px;
            background-color: rgba(0,0,0,0.3);
            padding: 15px 0;
            flex-shrink: 0;
            display: flex;
            flex-direction: column;
            gap: 10px;
            height: 100%;
        }
        .setting-sidebar-btn {
            height: 40px;
            line-height: 40px;
            text-align: center;
            color: #fff;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
            border-left: 3px solid transparent;
        }
        .setting-sidebar-btn.active {
            background-color: rgba(255,215,0,0.2);
            color: #FFD700;
            border-left-color: #FFD700;
        }
        .setting-content {
            flex-grow: 1;
            padding: 20px;
            overflow-y: auto !important;
            display: none;
            -webkit-overflow-scrolling: touch;
            touch-action: pan-y;
            height: 100%;
        }
        .setting-content.active { display: block; }
        .setting-group {
            background-color: rgba(0,0,0,0.2);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }
        .setting-group h3 { color: #FFD700; margin-bottom: 10px; font-size: 16px; }
        .setting-item {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 12px;
            width: 100%;
        }
        .setting-item label { font-size: 14px; color: #fff; }
        .setting-item input, .setting-item select {
            padding: 8px 10px;
            border-radius: 4px;
            border: 1px solid rgba(255,255,255,0.2);
            background-color: rgba(0,0,0,0.3);
            color: #fff;
            outline: none;
            width: 100%;
        }
        .setting-item input[type="range"] { padding: 0; }
        .color-selector { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 10px; }
        .color-block {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid transparent;
            transition: transform 0.2s ease;
        }
        .color-block:hover { transform: scale(1.1); }
        .color-block.active { border-color: #FFD700; }
        .software-info { font-size: 16px; line-height: 2; color: #eee; padding: 20px; }

        .tab-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 65px;
            background: rgba(0,0,0,0.5);
            display: flex;
            justify-content: space-around;
            align-items: center;
            z-index: 100;
            border-top: 2px solid #FFD700;
        }
        .tab-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #ccc;
            cursor: pointer;
            transition: color 0.2s ease;
            font-size: 12px;
            gap: 4px;
            padding: 5px 0;
        }
        .tab-item.active { color: #FFD700; }
        .tab-icon { font-size: 20px; }
        .home-page {
            display: block;
            height: 100%;
            width: 100%;
        }
        @media (max-width: 360px) {
            .song-list-content.three-col {
                grid-template-columns: repeat(auto-fit, minmax(90px, 1fr));
            }
            .song-item {
                padding: 6px 6px;
                min-height: 50px;
            }
        }
        @media (min-width: 400px) {
            .song-list-content.two-col {
                grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <base target="_blank">
</head>
<body>
    <div class="bg-container" id="bgContainer"></div>
    <div class="collect-tip" id="collectTip"></div>
    <div class="container">
        <div class="header">
            <h1 id="title">情義江湖点歌系统</h1>
        </div>
        <div class="home-page" id="homePage">
            <div class="fixed-header">
                <div class="artist-section" id="tagContainer">
                    <button class="tag-btn active" data-artist="all">歌单大全</button>
                </div>
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="搜索歌曲">
                </div>
            </div>
            <div class="list-title">
                <h2 id="listTitle">歌曲列表 <span id="countText" class="song-count">(0首)</span></h2>
                <button id="layoutTrigger" class="list-control-btn">
                    <span id="layoutText">布局</span>
                    <svg class="arrow-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M7 10l5 5 5-5z" fill="currentColor"/>
                    </svg>
                </button>
                <button id="sortTrigger" class="list-control-btn">
                    <span id="sortText">排序</span>
                    <svg class="arrow-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M7 10l5 5 5-5z" fill="currentColor"/>
                    </svg>
                </button>
                <div id="layoutModal" class="modal">
                    <div class="modal-content">
                        <div class="modal-title" id="layoutModalTitle">布局设置</div>
                        <div class="modal-option">
                            <label for="layoutSingle">单排显示</label>
                            <input type="radio" id="layoutSingle" name="layoutType" value="single" checked>
                        </div>
                        <div class="modal-option">
                            <label for="layoutDouble">双排显示</label>
                            <input type="radio" id="layoutDouble" name="layoutType" value="double">
                        </div>
                        <div class="modal-option">
                            <label for="layoutTriple">三排显示</label>
                            <input type="radio" id="layoutTriple" name="layoutType" value="triple">
                        </div>
                        <div class="modal-footer">
                            <button class="modal-btn btn-cancel" id="layoutCancelBtn">取消</button>
                            <button class="modal-btn btn-confirm" id="layoutConfirmBtn">确定</button>
                        </div>
                    </div>
                </div>
                <div id="sortModal" class="modal">
                    <div class="modal-content">
                        <div class="modal-title" id="sortModalTitle">排序设置</div>
                        <div class="modal-option">
                            <label for="orderAsc">正序 (A-Z)</label>
                            <input type="radio" id="orderAsc" name="sortOrder" value="asc">
                        </div>
                        <div class="modal-option">
                            <label for="orderDesc">倒序 (Z-A)</label>
                            <input type="radio" id="orderDesc" name="sortOrder" value="desc">
                        </div>
                        <div class="modal-option">
                            <label for="orderRandom">随机排序</label>
                            <input type="radio" id="orderRandom" name="sortOrder" value="random" checked>
                        </div>
                        <hr style="border: 1px solid #333; margin: 15px 0;">
                        <div class="modal-option">
                            <label for="sortByTitle">按名称排序</label>
                            <input type="radio" id="sortByTitle" name="sortType" value="title" checked>
                        </div>
                        <div class="modal-option">
                            <label for="sortByArtist">按歌手排序</label>
                            <input type="radio" id="sortByArtist" name="sortType" value="artist">
                        </div>
                        <div class="modal-footer">
                            <button class="modal-btn btn-cancel" id="cancelBtn">取消</button>
                            <button class="modal-btn btn-confirm" id="confirmBtn">确定</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="song-list-wrapper">
                <div class="song-list-content" id="songListContainer"></div>
            </div>
        </div>
        <div class="collect-page" id="collectPage">
            <h3 id="collectTitle">我的收藏</h3>
            <p id="collectEmpty">暂无收藏歌曲</p>
        </div>
        <div class="setting-page" id="settingPage">
            <div class="setting-sidebar">
                <div class="setting-sidebar-btn active" data-target="lang-content">语言</div>
                <div class="setting-sidebar-btn" data-target="bg-content">背景</div>
                <div class="setting-sidebar-btn" data-target="software-content">软件</div>
            </div>
            <div class="setting-content active" id="lang-content">
                <div class="setting-group">
                    <h3 id="langTitle">语言设置</h3>
                    <div class="setting-item">
                        <label for="languageSelect">选择语言</label>
                        <select id="languageSelect">
                            <option value="zh">中文</option>
                            <option value="en">English</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="setting-content" id="bg-content">
                <div class="setting-group">
                    <h3 id="bgTitle">背景设置</h3>
                    <div class="setting-item">
                        <label for="bgFileInput">本地背景</label>
                        <input type="file" id="bgFileInput" accept="images/JH01.jpg*">
                    </div>
                    <div class="setting-item">
                        <label for="bgUrlInput" id="bgUrlLabel">网络背景</label>
                        <div style="display: flex; gap: 10px;">
                            <input type="text" id="bgUrlInput" placeholder="输入URL" style="flex: 1;">
                            <button id="bgUrlConfirmBtn" style="padding: 8px 15px; border-radius: 4px; border: 1px solid rgba(255,255,255,0.2); background-color: rgba(0,0,0,0.3); color: #FFD700; cursor: pointer; font-weight: bold;">确定</button>
                        </div>
                    </div>
                    <div class="setting-item">
                        <label for="bgOpacity">背景透明度</label>
                        <input type="range" id="bgOpacity" min="0.1" max="1" step="0.1" value="1">
                        <span id="opacityValue">100%</span>
                    </div>
                    <div class="setting-item">
                        <label id="bgColorLabel">纯色背景</label>
                        <div class="color-selector">
                            <div class="color-block" style="background-color: #000000;" data-color="#000000"></div>
                            <div class="color-block" style="background-color: #FFFFFF;" data-color="#FFFFFF"></div>
                            <div class="color-block" style="background-color: #8B0000;" data-color="#8B0000"></div>
                            <div class="color-block" style="background-color: #008000;" data-color="#008000"></div>
                            <div class="color-block" style="background-color: #FFA500;" data-color="#FFA500"></div>
                            <div class="color-block" style="background-color: #FFFF00;" data-color="#FFFF00"></div>
                            <div class="color-block" style="background-color: #800080;" data-color="#800080"></div>
                            <div class="color-block" style="background-color: #0000FF;" data-color="#0000FF"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="setting-content" id="software-content">
                <div class="software-info">
                    <p>版本：V1.0</p>
                    <p>作者：汤晨</p>
                </div>
            </div>
        </div>
    </div>
    <div class="tab-bar">
        <div class="tab-item active" id="homeTab">
            <i class="fas fa-home tab-icon"></i>
            <span id="homeText">首页</span>
        </div>
        <div class="tab-item" id="collectTab">
            <i class="fas fa-star tab-icon"></i>
            <span id="collectText">收藏</span>
        </div>
        <div class="tab-item" id="settingTab">
            <i class="fas fa-cog tab-icon"></i>
            <span id="settingText">设置</span>
        </div>
    </div>
    <script>
    // ====================== 默认背景图片配置 ======================
    const DEFAULT_BG_URL = 'https://jianghu-0gpk3pxh37b5503e-1392378192.tcloudbaseapp.com/images/JH01.jpg';

        // ====================== 歌手&歌曲集中配置区（核心维护区） ======================
        const artistConfig = {
            judy: { 
                name: "女歌 Judy", 
                songs: 
`
阿刁
爱
爱上一个不回家的人
爱不爱我
爱人跟人走（台）
爱拼才会赢（台）
爱之初体验
爱什么稀罕
爱你A.I.N.Y
爱你在心口难开
爱囚
爱如潮水
爱很简单
爱的箴言
爱要坦荡荡
爱要怎么说出口
爱要有你才完美
爱情的骗子我问你（台）
爱我的人和我爱的人
爱的供养
爱一个人好难
爱我别走
爱的主打歌
安妮
暗香
Bad Boy
不管有多苦
不再犹豫（粤）
不在乎他
不让我的眼泪陪我过夜
不必太在意
不值得
别在伤口撒盐
北京一夜
北方的狼
白天不懂夜的黑
把耳朵叫醒
宝贝对不起
存在
偿还
传奇
丑八怪
成都
城里的月光
晨间新闻
赤伶
趁早
出卖
错位时空
但愿人长久
大约在冬季
多幸运
丹顶鹤的故事
倒数
冬天里的一把火
单身情歌
大海
大鱼
大风吹
对你爱不完
带我到山顶
当
当我开始偷偷的想你
当爱在靠近
滴答滴
电台情歌
短发
胆小鬼
放开
风吹麦浪
风流女生
风的季节（粤）
凡人歌
光年之外
光辉岁月（粤）
关键词
干杯.朋友
刚好遇见你
感恩的心
告白气球
改变自己
给我一个吻
跟着感觉走
花心
何日君再来
过火
过客
海阔天空（粤）
后来
嗨歌
挥着翅膀的女孩
回家
好胆你就来
火
红玫瑰
红豆
红颜
剪爱
加速度
姐妹
姐姐妹妹站起来
寂寞先生
就现在
江南
解脱
讲真的
酒干倘卖无
记事本
空心
空空如也
可惜不是你
可惜没如果
哭不出来
开门见山
快乐的人请举手
两个人的回忆一个人过
李白
来自天堂的魔鬼
离不开你
离歌
离人愁
兰花草
蓝天
领悟
龙卷风
龙的传人
绿岛小夜曲
老鼠爱大米
梦一场
梦醒了
梦醒时分
没离开过
没那么简单
闷
魔鬼中的天使
默
梅花三弄
漫步人生路（粤）
眉飞色舞
明天你是否依然爱我
明天会更好
南屏晚钟
你的眼睛像星星
你一定要幸福
你不是真正的快乐
你怎么舍得我难得
你把我灌醉
你的眼神
你的酒馆对我打了佯
你知道我在等你吗
你还要我怎样
你怎么说
恼人的秋风
女儿情
女人花
男孩
朋友（周华健）
泡沫
漂洋过海来看你
飘雪（粤）
情非得已
前门情思大碗茶
囚鸟
千千阙歌（粤）
千年之恋
起风了
敲敲我的头
千年等一回
情网
青苹果乐园
青藏高原
千言万语
牵丝戏
亲密爱人
如愿
如果云知道
如果没有你
让我欢喜让我忧
让我一次爱个够
super star
水中花
三天三夜
失恋阵线联盟
十年
伤痕
少年
说唱脸谱
说散就散
身骑白马
他一定很爱你
特别的爱给特别的你
体面
同桌的你
听海
天涯歌女
天路
太委屈
太阳
跳进来
桃花诺
桃花朵朵开
问
无人之岛
无地自容
我要找到你
我的好兄弟
我和草原有个约定
我要你
我是一只小小鸟
我最亲爱的
我的未来不是梦
我想有个家
我可以抱你吗
我只在乎你
为你我受冷风吹
为爱痴狂
味道
往事随风
外婆的澎湖湾
外面的世界
往后余生
忘记拥抱
忘了没有
忘情水
悟空
我在人民广场吃炸鸡
我好想你
我怀念的
我是不是你最疼爱的人
我曾用心的爱着你
我的心里只有你没有他
我的歌声里
我的秘密
我相信
我等到花儿也谢了
吻别
新贵妃醉酒
信仰
像鱼
喜欢你（粤）
小情歌
想你的夜
想着你的感觉
新不了情
相见恨晚
辛德瑞拉
星语心愿
陷阱
潇洒走一回
谢谢你的爱
小城故事
香水有毒
下个，路口，见
一个人的精彩
一生何求（粤）
一人有一个梦想（粤）
一个人跳舞
一想到你呀
一生所爱（粤）
一样的月光
一无所有
一支小雨伞（台）
友谊之光（粤）
勇气
原来你什么都不想要
愿赌服输
因为爱所以爱
夜夜夜
夜来香
夜上海
易燃易爆炸
映山红
云与海
月亮代表我的心
月半小夜曲（粤）
月牙湾
月亮之上
隐形的翅膀
有多少爱可以重来
用心良苦
远走高飞
遇见
野子
野百合也有春天
野花
雨花石
雨蝶
愿得一人心
值得
再见
再回首
再见只是陌生人
张三的歌
怎么说我不爱你
执着
最浪漫的事
最熟悉的陌生人
最美
最美的期待
最炫民族风
自由飞翔
真情人
至少还有你
走着走着就散了
走马
追梦人
掌声响起
只有你过得比我好
爱是你我
美丽的神话
广岛之恋
今天你要嫁给我
铁血丹心
世间始终你好
天下有情人
想把我唱给你听
刀马旦
相思风雨中
因为爱情
制造浪漫
知心爱人
有一点动心
明明白白我的心
你莫走
Can't take my eyes off you
Careless whisper
Close to you
Cheap thrills
Dance monkey
Diamonds
Don't know why
Dream a little dream
Dum tek tek
Eternal flame
Fly me to the moon
Give one reason
God is a girl
Hero
Honey
Honey,i'm home
Hotel california
How do i live
I kissed a girl
I will always love you
I hate myself for loving you
Knocking on heaven's door
Killing me softly
Loving you
La isla bonida
Man i feel like woman
My heart will go on
Price tag
Rolling in the deep
Sha la la
Sunrise
Superstar
Smooth operator
This masquerade
Try
The power of love
Unbreak my heart
Underneath your clothes
Venus
What's up
Whataya want from me
Without you
You're still the one
Yesterday once more

` 
            },
            ting: { 
                name: "女歌 小婷", 
                songs: 
`
乌兰巴巴托的夜 
旅行
阳光彩虹小白马
把悲伤留给自己
生而为人
男孩
时间煮雨
岁月神偷
趁你还年轻
爱
花心
有多少爱可以重来
好久不见
像鱼
红玫瑰
魔鬼中的天使
不要怕
羞答答的玫瑰静悄悄的开
这世界那么多人
说散就散
后来
亲爱的小孩
你就不要想起我
我的声音
姐姐妹妹站起来
像我这样的人
易燃易爆炸
我管你
那些花儿
没那么简单
我好像在哪见过
我们的爱
可惜不是你
A hundred miles
爱丫爱丫
不该用情
演员
胡广生
斑马斑马
我很快乐
到不了
刚刚好
我等到花儿也谢了
七月上
其实都没有
红豆 
你要跳舞吗
第一次爱的人
空心
奇迹再现 
不醉不会
带我到山顶
给我一个理由忘记 
我们的时光
雨蝶
睫毛弯弯
说散就散
我很快乐
失恋阵线联盟
别错过
走过咖啡屋
谁
Lydia 
恭喜发财
伤心的人别听慢歌
隐形的翅膀
至少还有你
暖暖
追光者
爱人错过
相爱后动物感伤
爱的初体验
如果你也听说
离开地球表面
哈哈哈 
桃花诺
推开世界的门
日不落
百年孤寂
看月亮爬上来
刚刚好
感官先生
头发乱了
咕叽咕叽
逆光
风的季节
饿狼传说
晚婚
执迷不悔
处处吻E
离别开出花
好胆你就来
为你唱首歌
再见琳尼多了
表白
爱笑的眼睛
欧若拉
在加纳共和国离婚
潇洒小姐
字字句句
若是月亮还没来
恋爱ing
阳光宅男
作曲家
我要夏天
你的微笑
不想长大

` 
            },
            zhiyu: { 
                name: "男歌 致宇", 
                songs: 
`
像梦一样自由    汪峰
夕阳醉了		张学友
童话		       光良
不再犹豫		Beyond 
护花使者		李克勤
浮夸		       陈奕迅
十年		       陈奕迅
只是太爱你		张敬轩
淘汰		       陈奕迅
花心		       周华健
兄弟 		       任贤齐
在他乡		      水木年华
爱我的人和我爱的人		游鸿明
暗里着迷		刘德华
今天		       刘德华
挪威的森林		伍佰
再回首		       姜育恒
偷心		       张学友
好想好想		古巨基
我是愤怒		Beyond 
从头再来		崔健
Monica		       古巨基
再度重相逢		伍佰
风往北吹		孙楠
遥远的她		张学友
乱世巨星		陈小春
红日		       李克勤
改变自己		王力宏
讲不出再见		谭咏麟
小小的太阳		张宇
凡人歌		       李宗盛
难念的经		周华健
谢谢你的爱		刘德华
一生所爱		李克勤
一生中最爱		谭咏麟
一生不变		李克勤
独家记忆		陈小春
背叛		       曹格
忘了你忘了我		王杰
平凡之路		朴树
别让我一个醉		姜育恒
一起走过的日子		刘德华
富士山下		陈奕迅
你怎么舍得我难过		黄品源
安妮		王杰
不将就		李荣浩
十七岁		刘德华
忘记你我做不到		张学友
风往北吹		       孙楠
如果这都不算爱		张学友
普通朋友		陶喆
爱不爱我		零点乐队
那就这样吧		动力火车
南方姑娘		赵雷
暗香		       沙宝亮
突然好想你		五月天
回头太难		张学友
爱很简单		陶喆
朋友别哭		吕方
海阔天空		Beyond 
光辉岁月		Beyond 
痴心绝对		李圣杰
一生有你		水木年华
有多少爱可以重来		迪克牛仔
七里香		周杰伦
单身情歌		              林志炫
我这个你不爱的人		迪克牛仔
当你孤单你会想起谁		张栋梁
原来的我		齐秦
一路上有你		张学友
男孩		       梁博
需要人陪		王力宏
像我这样的人		毛不易
真的爱你		Beyond 
给你们		        张宇
爱你一万年		刘德华
女人的选择		姜育恒
别让我一个人醉		姜育恒
我们的歌		王力宏
贝加尔湖畔		李健
活着		       郝云
小镇姑娘		陶喆
今夜你会不会来		黎明
我是真的爱上你		王杰
让一切随风		钟镇涛
朋友		       周华健
心跳		       王力宏
情非得已		庾澄庆
一场游戏一场梦		王杰
一千个伤心的理由		张学友
模特		李荣浩
如果没有你		萧敬腾
成都		赵雷
甘心替代你		郑伊健
千千阙歌		陈慧娴
雨一直下		张宇
当年情		张国荣
冰雨		刘德华
吻别		张学友
朋友		谭咏麟
沉默是金		许冠杰
如果你是我的传说		刘德华
笨小孩		刘德华
她来听我的演唱会		张学友
情人		Beyond 
月半小夜曲		李克勤
一生何求		陈百强
偏偏喜欢你		陈百强
冷雨夜		Beyond 
无赖		郑中基
漫步人生路		邓丽君
用心良苦		张宇
突然的自我		伍佰
传奇		李健
那些你冒险的梦		林俊杰
你是我心爱的姑娘		汪峰
怒放的生命		汪峰
你就不要想起我		简弘亦
蓝莲花		许巍
曾经的你		许巍
龙卷风		周杰伦
简单爱		周杰伦
春风十里		鹿先生乐队
男孩别哭		海龟先生
下一个天亮		半吨兄弟
明天你是否依然爱我		童安格
江南		林俊杰
成全		林宥嘉
恋曲1990		罗大佑
笑看风云		郑少秋
嘉宾		张远
不浪漫罪名		王杰
梦醒时分		伍佰
北京北京		汪峰
友情岁月		陈小春
你把我灌醉		黄大炜
我只在乎你		邓丽君
无所谓		杨坤
月亮代表我的心		齐秦
因为爱所以爱		谢霆锋
这世界那么多人		林志炫
雨中的恋人们		黄凯芹
空白格		杨宗伟
练习		刘德华
世界第一等		刘德华
星晴		周杰伦
我可以抱你吗		张惠妹
离人		林志炫
你的样子		林志炫
第一次		光良
最远的你是我最近的爱		车继玲
稳稳的幸福		陈奕迅
灰色轨迹		Beyond 
离开以后             张学友
倩女幽魂             张国荣
只要你过得比我好   钟镇涛

` 
            },
            echo: { 
                name: "男歌 Echo", 
                songs: 
`
梦醒时分C
隆里电丝 (Live)E
如果这都不算爱D
花海F
爱的飞行日记E
大城小爱C
风继续吹C
霍元甲F
危险派对E
霓虹甜心G
我是真的爱上你E
New Boy (Live)盘尼西林乐队C
爱笑的眼睛C
Monica F
一生中最爱C#
讲不出再见C
安妮C
夕阳醉了Bb
凡人歌Eb
当年情Eb
爱的初体验G
天天A转Bb
海龟先生Gj
初恋 (Live)F#
曹操Eb
春风十里E
离人D
十年G
鬼迷心窍C
晚婚 C
问 G
出现又离开G
男孩C
红日C
海鸥G
爱我还是他A
找自己A
普通朋友Eb
爱很简单C
就是爱你G转Ab
稻香A
告白气球Ab
简单爱Bb
一路向北C
明明就F
记得Eb
好想好想E

水中花D
恋曲1990D
成都D
味道D
有没有人告诉你G
不浪漫罪名E
天下D
谢谢你的爱1999E
戒烟G
作曲家G
水星记E
可乐Eb
阳光宅男C#
你的背包E
特别的人G
我们俩G
暗里着迷C
莉莉安G
我可以F#
你要的爱 B
刻在我心底的名字A#
小城夏天LBI利比G
修炼爱情C
风再起时A
鼓楼 G
我们的时光 F
过火Bb
那些花儿G
一生所爱E
年少有为A
寂寞难耐 G
程艾影D
南方姑娘F
三十岁的女人D
阿刁赵雷 F
朵儿F
风吹一夏 龙猪Ab
有多少爱可以重来Ab
山丘李宗盛Eb
凄美地G
再见杰克F
爱要怎么说出口A
一场游戏一场梦A
夜夜夜夜G
那就这样吧D
流沙G
爱我别走C
月半小夜曲Ab
小镇姑娘Bb
给自己的歌Bb
新不了情C
搁浅D转Eb
鲜花  回春丹乐队 D
私奔郑钧F#
需要人陪F
失恋阵线联盟F
康姆士乐团 你要如何，我们就如何A
怎么说我不爱你C
偏偏喜欢你G
Melody陶喆 D
悬崖C
爱不爱我G
玫瑰C
梦一场G
寂寞先生G
不让我的眼泪陪我过夜A
袖手旁观B
阿飞的小蝴蝶G
无情的雨，无情的你D
画赵雷G
安妮王杰C
南山南马頔 B
嘿!姑娘反光镜乐队G
理想G
小宇A
一滴泪的时间
理想三旬Bb
一滴泪的时间C
突然好想你C
温柔G
春风十里E

` 
            },
                    }

        // ====================== GitHub背景图片自动播放配置（新增核心代码） ======================
        const GITHUB_CONFIG = {
            // ⚠️⚠️⚠️ 必须修改以下三个参数 ⚠️⚠️⚠️
            username: 'tangchen0528',  // 你的GitHub用户名
            repo: 'jianghu',            // 仓库名称
            path: 'images',         // 图片文件夹（如：assets 或 images）
            
            // 以下参数可按需调整
            branch: 'main',          // 分支名
            autoRotate: true,        // 是否自动轮换
            interval: 5000,          // 切换间隔（毫秒）
            randomOrder: false       // 是否随机顺序 true是 false否 
        };

        // 获取GitHub文件夹中的图片列表
        async function fetchGitHubImages() {
            const apiUrl = `https://api.github.com/repos/${GITHUB_CONFIG.username}/${GITHUB_CONFIG.repo}/contents/${GITHUB_CONFIG.path}`;
            
            try {
                const response = await fetch(apiUrl, {
                    headers: { 'Accept': 'application/vnd.github.v3+json' }
                });
                
                if (!response.ok) throw new Error(`HTTP ${response.status}`);
                
                const files = await response.json();
                return files
                    .filter(file => /.(jpg|jpeg|png|gif|webp)$/i.test(file.name))
                    .map(file => ({
                        name: file.name,
                        url: `https://raw.githubusercontent.com/${GITHUB_CONFIG.username}/${GITHUB_CONFIG.repo}/${GITHUB_CONFIG.branch}/${GITHUB_CONFIG.path}/${encodeURIComponent(file.name)}`
                    }));
            } catch (error) {
                console.warn('GitHub图片加载失败:', error);
                return [];
            }
        }

        // 背景轮换器
        class BackgroundRotator {
            constructor() {
                this.images = [];
                this.currentIndex = 0;
                this.intervalId = null;
            }
            
            async init() {
                this.images = await fetchGitHubImages();
                if (this.images.length === 0) return;
                
                if (GITHUB_CONFIG.randomOrder) {
                    this.images = this.images.sort(() => Math.random() - 0.5);
                }
                
                this.nextImage();
                if (GITHUB_CONFIG.autoRotate) this.start();
            }
            
            start() {
                this.stop();
                this.intervalId = setInterval(() => this.nextImage(), GITHUB_CONFIG.interval);
            }
            
            stop() {
                if (this.intervalId) clearInterval(this.intervalId);
            }
            
            nextImage() {
                if (this.images.length === 0) return;
                const image = this.images[this.currentIndex];
                bgContainer.style.backgroundImage = `url(${image.url})`;
                currentBgType = 'image';
                this.currentIndex = (this.currentIndex + 1) % this.images.length;
            }
        }

        const bgRotator = new BackgroundRotator();

        // ====================== 自动构建数据（无需修改） ======================
        function convertSongList(songText, artistKey, artistName) {
            return songText.split('\n').filter(title => title.trim()).map((title, index) => ({
                id: `${artistKey}_${index + 1}`,
                title: title.trim().replace(/^\d+[\.\s]+/, ''),
                artist: artistName,
                cover: title.trim().replace(/^\d+[\.\s]+/, '').charAt(0) || '♪'
            }));
        }

        const musicData = { all: [] };
        Object.keys(artistConfig).forEach(artistKey => {
            const config = artistConfig[artistKey];
            musicData[artistKey] = convertSongList(config.songs, artistKey, config.name);
            musicData.all = musicData.all.concat(musicData[artistKey]);
        });

        // ====================== 页面元素 ======================
        const bgContainer = document.getElementById('bgContainer');
        const homePage = document.getElementById('homePage');
        const collectPage = document.getElementById('collectPage');
        const settingPage = document.getElementById('settingPage');
        const homeTab = document.getElementById('homeTab');
        const collectTab = document.getElementById('collectTab');
        const settingTab = document.getElementById('settingTab');
        const tagContainer = document.getElementById('tagContainer');
        const searchInput = document.getElementById('searchInput');
        const songListContainer = document.getElementById('songListContainer');
        const countText = document.getElementById('countText');
        const layoutTrigger = document.getElementById('layoutTrigger');
        const layoutModal = document.getElementById('layoutModal');
        const layoutSingle = document.getElementById('layoutSingle');
        const layoutDouble = document.getElementById('layoutDouble');
        const layoutTriple = document.getElementById('layoutTriple');
        const layoutCancelBtn = document.getElementById('layoutCancelBtn');
        const layoutConfirmBtn = document.getElementById('layoutConfirmBtn');
        const sortTrigger = document.getElementById('sortTrigger');
        const sortModal = document.getElementById('sortModal');
        const orderAsc = document.getElementById('orderAsc');
        const orderDesc = document.getElementById('orderDesc');
        const orderRandom = document.getElementById('orderRandom');
        const sortByTitle = document.getElementById('sortByTitle');
        const sortByArtist = document.getElementById('sortByArtist');
        const cancelBtn = document.getElementById('cancelBtn');
        const confirmBtn = document.getElementById('confirmBtn');
        const languageSelect = document.getElementById('languageSelect');
        const bgFileInput = document.getElementById('bgFileInput');
        const bgOpacity = document.getElementById('bgOpacity');
        const opacityValue = document.getElementById('opacityValue');
        const bgUrlInput = document.getElementById('bgUrlInput');
        const bgUrlConfirmBtn = document.getElementById('bgUrlConfirmBtn');
        const collectEmpty = document.getElementById('collectEmpty');
        const collectTip = document.getElementById('collectTip');

        // ====================== 状态管理 ======================
        let currentSongs = musicData.all;
        let originalSongs = [...currentSongs];
        let previousState = { order: 'random', type: 'title' };
        let previousLayout = 'single';
        let collectSongs = [];
        let currentBgType = 'color';
        let currentColor = '#8B0000';
        let tempLayout = previousLayout;
        let tempSortState = { ...previousState };

        // ====================== 语言包 ======================
        const langPkg = {
            zh: {
                title: "情義江湖点歌系统", homeText: "首页", collectText: "收藏", settingText: "设置",
                allTag: "歌单大全", searchPlaceholder: "搜索歌曲", listTitle: "歌曲列表",
                layoutText: "布局", sortText: "排序", layoutModalTitle: "布局设置",
                singleLabel: "单排显示", doubleLabel: "双排显示", tripleLabel: "三排显示",
                sortModalTitle: "排序设置", ascLabel: "正序 (A-Z)", descLabel: "倒序 (Z-A)",
                randomLabel: "随机排序", sortTitleLabel: "按名称排序", sortArtistLabel: "按歌手排序",
                cancelBtn: "取消", confirmBtn: "确定", collectTitle: "我的收藏", collectEmpty: "暂无收藏歌曲",
                noSongTip: "无匹配歌曲", langTitle: "语言设置", langLabel: "选择语言",
                bgTitle: "背景设置", bgImgLabel: "选择本地背景图片", bgUrlLabel: "或输入网络图片URL",
                opacityLabel: "背景透明度", bgColorLabel: "选择纯色背景"
            },
            en: {
                title: "Qingyi Jianghu Song System", homeText: "Home", collectText: "Collect", settingText: "Settings",
                allTag: "All Songs", searchPlaceholder: "Search Songs", listTitle: "Song List",
                layoutText: "Layout", sortText: "Sort", layoutModalTitle: "Layout Settings",
                singleLabel: "Single Column", doubleLabel: "Double Columns", tripleLabel: "Triple Columns",
                sortModalTitle: "Sort Settings", ascLabel: "Ascending (A-Z)", descLabel: "Descending (Z-A)",
                randomLabel: "Random Order", sortTitleLabel: "Sort by Title", sortArtistLabel: "Sort by Artist",
                cancelBtn: "Cancel", confirmBtn: "Confirm", collectTitle: "My Collection", collectEmpty: "No collected songs",
                noSongTip: "No matching songs", langTitle: "Language Settings", langLabel: "Select Language",
                bgTitle: "Background Settings", bgImgLabel: "Select Local Background", bgUrlLabel: "Or enter image URL",
                opacityLabel: "Background Opacity", bgColorLabel: "Select Solid Color Background"
            }
        };

        // 初始化页面
        function initPage() {
            renderArtistTags();
            renderSongList(currentSongs);
            loadCollectSongs();
            updateCollectPage();
            initBackground();
            setupEventListeners();
        }

        // 渲染歌手标签
        function renderArtistTags() {
            Object.keys(artistConfig).forEach(artistKey => {
                const artist = artistConfig[artistKey];
                const tagBtn = document.createElement('button');
                tagBtn.className = 'tag-btn';
                tagBtn.dataset.artist = artistKey;
                tagBtn.textContent = artist.name;
                tagContainer.appendChild(tagBtn);
            });
        }

        // 渲染歌曲列表
        function renderSongList(songs) {
            songListContainer.innerHTML = '';
            countText.textContent = `(${songs.length}首)`;
            
            if (songs.length === 0) {
                const noSongTip = document.createElement('div');
                noSongTip.className = 'no-song-tip';
                noSongTip.textContent = langPkg[languageSelect.value].noSongTip;
                songListContainer.appendChild(noSongTip);
                return;
            }
            
            songs.forEach(song => {
                const isCollected = collectSongs.some(item => item.id === song.id);
                const songItem = document.createElement('div');
                songItem.className = 'song-item';
                songItem.dataset.id = song.id;
                
                songItem.innerHTML = `
                    <div class="thumbnail">
                        <div class="placeholder-img">${song.cover}</div>
                    </div>
                    <div class="song-details">
                        <div class="song-title">${song.title}</div>
                        <div class="song-artist">${song.artist}</div>
                    </div>
                    <i class="fas fa-star collect-star ${isCollected ? 'active' : ''}"></i>
                `;
                
                songListContainer.appendChild(songItem);
                
                // 添加收藏事件
                const starIcon = songItem.querySelector('.collect-star');
                starIcon.addEventListener('click', (e) => {
                    e.stopPropagation();
                    toggleCollect(song);
                    starIcon.classList.toggle('active');
                });
            });
        }

        // 切换收藏状态
        function toggleCollect(song) {
            const index = collectSongs.findIndex(item => item.id === song.id);
            if (index > -1) {
                collectSongs.splice(index, 1);
                showCollectTip('已取消收藏');
            } else {
                collectSongs.push(song);
                showCollectTip('已收藏');
            }
            localStorage.setItem('collectSongs', JSON.stringify(collectSongs));
            updateCollectPage();
        }

        // 显示收藏提示
        function showCollectTip(text) {
            collectTip.textContent = text;
            collectTip.classList.add('show');
            setTimeout(() => collectTip.classList.remove('show'), 1500);
        }

        // 加载收藏歌曲
        function loadCollectSongs() {
            const saved = localStorage.getItem('collectSongs');
            if (saved) {
                collectSongs = JSON.parse(saved);
            }
        }

        // 更新收藏页面
        function updateCollectPage() {
            const collectContainer = collectPage.querySelector('.song-list-content') || createCollectContainer();
            
            collectContainer.innerHTML = '';
            collectEmpty.style.display = collectSongs.length === 0 ? 'block' : 'none';
            
            collectSongs.forEach(song => {
                const songItem = document.createElement('div');
                songItem.className = 'song-item';
                songItem.dataset.id = song.id;
                
                songItem.innerHTML = `
                    <div class="thumbnail">
                        <div class="placeholder-img">${song.cover}</div>
                    </div>
                    <div class="song-details">
                        <div class="song-title">${song.title}</div>
                        <div class="song-artist">${song.artist}</div>
                    </div>
                    <i class="fas fa-star collect-star active"></i>
                `;
                
                collectContainer.appendChild(songItem);
                
                // 添加取消收藏事件
                const starIcon = songItem.querySelector('.collect-star');
                starIcon.addEventListener('click', (e) => {
                    e.stopPropagation();
                    toggleCollect(song);
                    starIcon.classList.toggle('active');
                });
            });
        }

        // 创建收藏容器
        function createCollectContainer() {
            const container = document.createElement('div');
            container.className = 'song-list-content single-col';
            collectPage.appendChild(container);
            return container;
        }

        // 初始化背景
        function initBackground() {
            bgContainer.style.backgroundColor = currentColor;
            bgContainer.style.opacity = bgOpacity.value;
            opacityValue.textContent = `${Math.round(bgOpacity.value * 100)}%`;
            
            // 尝试加载GitHub图片
            bgRotator.init().catch(err => {
                console.log('使用默认背景图');
                bgContainer.style.backgroundImage = `url(${DEFAULT_BG_URL})`;
                currentBgType = 'image';
            });
        }

        // 设置事件监听
        function setupEventListeners() {
            // 标签切换
            document.querySelectorAll('.tag-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.tag-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    const artist = btn.dataset.artist;
                    currentSongs = artist === 'all' ? musicData.all : musicData[artist];
                    originalSongs = [...currentSongs];
                    sortSongs(tempSortState.type, tempSortState.order);
                    renderSongList(currentSongs);
                });
            });

            // 搜索功能
            searchInput.addEventListener('input', () => {
                const keyword = searchInput.value.trim().toLowerCase();
                currentSongs = originalSongs.filter(song => 
                    song.title.toLowerCase().includes(keyword) || 
                    song.artist.toLowerCase().includes(keyword)
                );
                renderSongList(currentSongs);
            });

            // 布局模态框
            layoutTrigger.addEventListener('click', (e) => {
                e.stopPropagation();
                layoutModal.style.display = 'block';
                document.querySelectorAll('input[name="layoutType"]').forEach(radio => {
                    radio.checked = radio.value === previousLayout;
                });
            });

            // 排序模态框
            sortTrigger.addEventListener('click', (e) => {
                e.stopPropagation();
                sortModal.style.display = 'block';
                document.querySelectorAll('input[name="sortOrder"]').forEach(radio => {
                    radio.checked = radio.value === previousState.order;
                });
                document.querySelectorAll('input[name="sortType"]').forEach(radio => {
                    radio.checked = radio.value === previousState.type;
                });
            });

            // 关闭模态框
            document.addEventListener('click', (e) => {
                if (!layoutModal.contains(e.target) && e.target !== layoutTrigger) {
                    layoutModal.style.display = 'none';
                }
                if (!sortModal.contains(e.target) && e.target !== sortTrigger) {
                    sortModal.style.display = 'none';
                }
            });

            // 布局取消
            layoutCancelBtn.addEventListener('click', () => {
                layoutModal.style.display = 'none';
            });

            // 布局确认
            layoutConfirmBtn.addEventListener('click', () => {
                const layout = document.querySelector('input[name="layoutType"]:checked').value;
                songListContainer.className = `song-list-content ${layout}-col`;
                previousLayout = layout;
                layoutModal.style.display = 'none';
            });

            // 排序取消
            cancelBtn.addEventListener('click', () => {
                sortModal.style.display = 'none';
            });

            // 排序确认
            confirmBtn.addEventListener('click', () => {
                const order = document.querySelector('input[name="sortOrder"]:checked').value;
                const type = document.querySelector('input[name="sortType"]:checked').value;
                previousState = { order, type };
                sortSongs(type, order);
                renderSongList(currentSongs);
                sortModal.style.display = 'none';
            });

            // 标签页切换
            homeTab.addEventListener('click', () => {
                setActiveTab(homeTab);
                homePage.style.display = 'block';
                collectPage.style.display = 'none';
                settingPage.style.display = 'none';
            });

            collectTab.addEventListener('click', () => {
                setActiveTab(collectTab);
                homePage.style.display = 'none';
                collectPage.style.display = 'flex';
                settingPage.style.display = 'none';
                updateCollectPage();
            });

            settingTab.addEventListener('click', () => {
                setActiveTab(settingTab);
                homePage.style.display = 'none';
                collectPage.style.display = 'none';
                settingPage.style.display = 'flex';
            });

            // 设置标签切换
            document.querySelectorAll('.setting-sidebar-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.setting-sidebar-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    const target = btn.dataset.target;
                    document.querySelectorAll('.setting-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    document.getElementById(target).classList.add('active');
                });
            });

            // 语言切换
            languageSelect.addEventListener('change', changeLanguage);

            // 背景透明度
            bgOpacity.addEventListener('input', () => {
                const value = parseFloat(bgOpacity.value);
                bgContainer.style.opacity = value;
                opacityValue.textContent = `${Math.round(value * 100)}%`;
            });

            // 本地背景
            bgFileInput.addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        bgContainer.style.backgroundImage = `url(${event.target.result})`;
                        currentBgType = 'image';
                        bgRotator.stop();
                    };
                    reader.readAsDataURL(file);
                }
            });

            // 网络背景
            bgUrlConfirmBtn.addEventListener('click', () => {
                const url = bgUrlInput.value.trim();
                if (url) {
                    bgContainer.style.backgroundImage = `url(${url})`;
                    currentBgType = 'image';
                    bgRotator.stop();
                }
            });

            // 纯色背景
            document.querySelectorAll('.color-block').forEach(block => {
                block.addEventListener('click', () => {
                    document.querySelectorAll('.color-block').forEach(b => b.classList.remove('active'));
                    block.classList.add('active');
                    const color = block.dataset.color;
                    bgContainer.style.backgroundImage = 'none';
                    bgContainer.style.backgroundColor = color;
                    currentBgType = 'color';
                    currentColor = color;
                    bgRotator.stop();
                });
            });
        }

        // 设置激活标签
        function setActiveTab(tab) {
            document.querySelectorAll('.tab-item').forEach(t => t.classList.remove('active'));
            tab.classList.add('active');
        }

        // 切换语言
        function changeLanguage() {
            const lang = languageSelect.value;
            document.getElementById('title').textContent = langPkg[lang].title;
            document.getElementById('homeText').textContent = langPkg[lang].homeText;
            document.getElementById('collectText').textContent = langPkg[lang].collectText;
            document.getElementById('settingText').textContent = langPkg[lang].settingText;
            document.querySelector('.tag-btn[data-artist="all"]').textContent = langPkg[lang].allTag;
            document.getElementById('searchInput').placeholder = langPkg[lang].searchPlaceholder;
            document.getElementById('listTitle').innerHTML = `${langPkg[lang].listTitle} <span id="countText" class="song-count">(${currentSongs.length}首)</span>`;
            document.getElementById('layoutText').textContent = langPkg[lang].layoutText;
            document.getElementById('sortText').textContent = langPkg[lang].sortText;
            document.getElementById('layoutModalTitle').textContent = langPkg[lang].layoutModalTitle;
            document.getElementById('layoutSingle').nextElementSibling.textContent = langPkg[lang].singleLabel;
            document.getElementById('layoutDouble').nextElementSibling.textContent = langPkg[lang].doubleLabel;
            document.getElementById('layoutTriple').nextElementSibling.textContent = langPkg[lang].tripleLabel;
            document.getElementById('sortModalTitle').textContent = langPkg[lang].sortModalTitle;
            document.getElementById('orderAsc').nextElementSibling.textContent = langPkg[lang].ascLabel;
            document.getElementById('orderDesc').nextElementSibling.textContent = langPkg[lang].descLabel;
            document.getElementById('orderRandom').nextElementSibling.textContent = langPkg[lang].randomLabel;
            document.getElementById('sortByTitle').nextElementSibling.textContent = langPkg[lang].sortTitleLabel;
            document.getElementById('sortByArtist').nextElementSibling.textContent = langPkg[lang].sortArtistLabel;
            document.querySelectorAll('.btn-cancel').forEach(btn => btn.textContent = langPkg[lang].cancelBtn);
            document.querySelectorAll('.btn-confirm').forEach(btn => btn.textContent = langPkg[lang].confirmBtn);
            document.getElementById('collectTitle').textContent = langPkg[lang].collectTitle;
            document.getElementById('collectEmpty').textContent = langPkg[lang].collectEmpty;
            document.getElementById('langTitle').textContent = langPkg[lang].langTitle;
            document.querySelector('label[for="languageSelect"]').textContent = langPkg[lang].langLabel;
            document.getElementById('bgTitle').textContent = langPkg[lang].bgTitle;
            document.querySelector('label[for="bgFileInput"]').textContent = langPkg[lang].bgImgLabel;
            document.getElementById('bgUrlLabel').textContent = langPkg[lang].bgUrlLabel;
            document.querySelector('label[for="bgOpacity"]').textContent = langPkg[lang].opacityLabel;
            document.getElementById('bgColorLabel').textContent = langPkg[lang].bgColorLabel;
            
            // 更新无歌曲提示
            if (currentSongs.length === 0) {
                const noSongTip = songListContainer.querySelector('.no-song-tip');
                if (noSongTip) noSongTip.textContent = langPkg[lang].noSongTip;
            }
        }

        // 排序歌曲
        function sortSongs(type, order) {
            if (order === 'random') {
                currentSongs = [...currentSongs].sort(() => Math.random() - 0.5);
                return;
            }
            
            currentSongs = [...currentSongs].sort((a, b) => {
                const valueA = a[type].toLowerCase();
                const valueB = b[type].toLowerCase();
                if (valueA < valueB) return order === 'asc' ? -1 : 1;
                if (valueA > valueB) return order === 'asc' ? 1 : -1;
                return 0;
            });
        }

        // 初始化页面
        initPage();
    </script>
</body>
</html>
